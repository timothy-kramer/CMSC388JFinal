{% extends "header.html" %}
{% block content %}
<div class="main-container">
  <div class="decoration-main-container"><div class="decoration-main"></div></div>
  <h2 class="main-title">Search a movie</h2>
  <form class="searchbar" action="/" method="POST">
    {{ form.csrf_token }}
    {{ form.search_query(class="form-control", placeholder="movie name") }}
    {% if form.search_query.errors %}
      <div class="error" role="alert">
        {% for error in form.search_query.errors %}
          <span>{{ error }}</span>
        {% endfor %}
      </div>
    {% endif %}
    {{ form.submit(class="form-button") }}
  </form>
  {% if current_user.is_authenticated %}
    <div class="watchlist-preview mt-8 flex flex-col items-center">
      <h3 class="text-2xl font-bold">Your Watchlist</h3>
      {% if watchlist_movies %}
        <ul class="mt-4 w-full max-w-md">
          {% for movie in watchlist_movies %}
            <li class="mb-2 text-center">
              <a href="{{ url_for('movies.movie_detail', movie_id=movie.imdb_id) }}" class="text-blue-500 hover:underline">
                {{ movie.movie_title }} (Priority: {{ movie.priority }})
              </a>
            </li>
          {% endfor %}
        </ul>
        <a href="{{ url_for('movies.watchlist') }}" class="mt-4 inline-block bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600">View Full Watchlist</a>
      {% else %}
        <p class="mt-4 text-gray-500">No movies on your watchlist.</p>
        <a href="{{ url_for('movies.watchlist') }}" class="mt-4 inline-block bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600">Go to Watchlist</a>
      {% endif %}
    </div>
  {% endif %}
</div>
{% endblock %}